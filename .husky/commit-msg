#!/usr/bin/env sh

# Nếu commitlint fail thì in hint rồi chặn commit
if ! npx --no -- commitlint --edit "$1" >/dev/stdout 2>&1; then
  # show commit message dòng đầu cho dev thấy mình vừa gõ gì
  first_line="$(head -n1 "$1" 2>/dev/null)"
  printf "\n❌ Commit message KHÔNG hợp lệ: \"%s\"\n" "$first_line"
  printf "ℹ️  Conventional Commits:\n"
  printf "   Format: type(scope?): subject\n"
  printf "   Types : feat | fix | docs | style | refactor | perf | test | build | ci | chore | revert\n"
  printf "   Ví dụ : feat(auth): add Google login on mobile\n"
  printf "           fix(ui): prevent header flicker on Android 14\n"
  exit 1
fi

exit 0
